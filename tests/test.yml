#!/usr/bin/env ansible-playbook
---
- name: run role
  hosts: machine
  tasks:
    - name: include role
      include_role:
        # link this role into ~/.ansible/roles
        name: locale

- name: reconnect to check locale
  hosts: machine
  environment:
    LC_ALL: en_US.utf8
    LANG: en_US.utf8
  tasks:

    - name: show locale
      command: locale
      register: locale
      failed_when: '"LC_ALL=en_US.utf8" not in locale.stdout'
